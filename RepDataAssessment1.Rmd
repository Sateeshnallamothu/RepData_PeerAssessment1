---
title: "RepAssignment1"
author: "Sateesh Nallamothu"
date: "January 8, 2017"
output: html_document
---
 
## R Markdown for Assignment 1 - (Reproduciable Research)
### Gathering Data
Fork and clone [gitHub repository for this assignment](https://github.com/rdpeng/RepData_PeerAssessment1). The data is available in 'Activity' folder under the name *activity.csv*. Make sure the CSV file is available in the working directory. The following R packages needs to be loaded for this assignment. 
``` {r rpackages,results='hold'}
library(lattice)
library(ggplot2)
library(data.table)
library(dplyr)
```

### Read input data
Set current working directory and load the activity data.
``` {r loaddata,error=FALSE,eval=FALSE}
setwd('RepData_PeerAssessment1')
```
```{r results='hold'}
activity <- read.csv(file='activity.csv',header = TRUE)
str(activity)
head(activity)
```

###What is mean total number of steps taken per day?

For this part of the assignment, you can ignore the missing values in the dataset.
1. Make a histogram of the total number of steps taken each day
2. Calculate and report the mean and median total number of steps taken per day

``` {r part1,results='hold'}
# check for NA in date and interval
mean(is.na(activity$date))
mean(is.na(activity$interval))
# convert data to ccyy-mm-dd
activity$date <- as.Date(activity$date,"%Y-%m-%d")

##What is mean total number of steps taken per day?  (ignore 'NA')
## 1. Make a histogram of the total number of steps taken each day
ttl.steps.per.day<-na.omit(activity)%>% 
                   group_by(date) %>%
                   summarize(ttl.steps = sum(steps,na.rm=TRUE))
head(ttl.steps.per.day)
 
```
``` {r dispplot}
step.range<-range(ttl.steps.per.day$ttl.steps)
hist(ttl.steps.per.day$ttl.steps,main="Histogram - Total number of steps per day", 
     xlab="Total number of steps in a day",col="red",ylim=c(0,30),
     xlim=step.range)
# 2. Calculate and report the mean and median total number of steps taken per day
me.steps<-mean(ttl.steps.per.day$ttl.steps)
md.steps<-median(ttl.steps.per.day$ttl.steps)
```

For question #2, the mean and median total number of steps taken per day are `r me.steps` and `r md.steps` respectively.

Another alternate way of plotting steps per day is by plotting daily historgram using ggplot
``` {r alternateplot,warning=FALSE,results='hold'}
dt.range<-range(ttl.steps.per.day$date)
ggplot(ttl.steps.per.day,aes(x=date, y=(ttl.steps)))+geom_histogram(stat="identity",binwidth = 0.1) +
  xlab("Date of measurement")+ylab("Number of steps")+
  scale_x_date( date_labels = "%Y-%m-%d",date_breaks = "1 day", 
                breaks=seq(min(ttl.steps.per.day$date), max(ttl.steps.per.day$date), 60),
                limits = dt.range)+
  theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust = 1))
```


###What is the average daily activity pattern?

1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

``` {r part2}
# 1.Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
avg.steps.per.interval<-na.omit(activity)%>% 
  group_by(interval) %>%
  summarize(avg.steps = mean(steps,na.rm=TRUE))  
avg.steps.per.interval
 
plot(avg.steps.per.interval, type="l",main="Avg. number of steps in 5 minute interval",
     xlab="Inteval in 5 mintues(hhmm)",ylab="Avg. steps",col="red",xaxt = "n")
axis(1, avg.steps.per.interval$interval, cex.axis = .5)
# 2.Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
max.steps<-avg.steps.per.interval[which.max(avg.steps.per.interval$avg.steps),]
max.steps
```

For question #2, the interval `r max.steps$interval` contains the maximum number of steps `r round(max.steps$avg.steps,0)`


